""" OLD_METHOD ISQED to TRAIN and INFERENCE
import torch
from datetime import date

default_epoch_range = 200
default_lr = 0.5
default_weight_decay = 0.0005

# spc_epoch_range = 200
# spc_lr = [0.1]*1 + [0.05]*1 + [0.02]*60 + [0.004]*40 + [0.0008]*40
# spc_weight_decay = 5e-4
# spc_momentum = 0.9

# 'Cifar10'
# 'Cifar100'
# 'SVHN'
DATA_SET = 'Cifar10'

TRAIN_FLAG = False
CONFIRM_TO_TRAIN = True

_today = date.today()
LOG_FILE_NAME = False or f"outlog.{DATA_SET}.m{_today.month}d{_today.day}.log"

# device to do the computation on
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
if torch.cuda.is_available():
    torch.cuda.set_device(0)

# default_manipulate_range = range(0, 4+1, 1)
default_manipulate_range = [0, 0.5, 1.0, 1.5, 2.0, 2.5, 3.0, 3.5, 4.0]
default_manipulate_divider = 1
delta = torch.tensor(
    [1, 0.5, 0.25, 0.125, 0.0675,
     -1, -0.5, -0.25, -0.125, -0.0675]
).to(device)
# delta *= 2
# delta /= 2
# delta /= 2
"""



#######################################################################################
########## only inference #############################################################
#######################################################################################
import torch
from datetime import date

# DELETE
default_manipulate_divider = 1

default_epoch_range = 200
default_lr = 0.5
default_weight_decay = 0.0005

# 'Cifar10'     -> main_manualModel
# 'Cifar100'
# 'SVHN'
# 'SST-2'        -> main_transformer
# 'NCI1'        -> main_GNN
DATA_SET = 'Cifar10'
BIT_LENGTH = 16

TRAIN_FLAG = False
CONFIRM_TO_TRAIN = True

_today = date.today()
LOG_FILE_NAME = False or f"outlog.{DATA_SET}.bit{BIT_LENGTH}.log"

# device to do the computation on
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
if torch.cuda.is_available():
    torch.cuda.set_device(1)
# default_manipulate_range = [0, 1, 5, 10, 15, 20, 100]
default_manipulate_range = []


"""to perform error rate in weekly time"""
# error_in_time = False

###################################### array multiplier
"""16-bit M-All-100%"""
error_in_time = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 4.4e-05, 0.000252, 0.000592, 0.001088, 0.001554, 0.002178, 0.003092, 0.004574, 0.007004, 0.00955, 0.012582, 0.015808, 0.018784, 0.021368, 0.023966, 0.026044, 0.027694, 0.02917, 0.030892, 0.032222, 0.03395, 0.036366, 0.039604, 0.04329, 0.047516, 0.05239, 0.057628, 0.063218, 0.06691, 0.06984, 0.073002, 0.075962, 0.07821, 0.080662, 0.08295, 0.085116, 0.088562, 0.092828, 0.097372, 0.102172, 0.106396, 0.111434, 0.116542, 0.121186, 0.125728, 0.129356, 0.13295, 0.136192, 0.138166, 0.140276, 0.142668, 0.145586, 0.14865, 0.152676, 0.156778, 0.160552, 0.165452, 0.169882, 0.174758, 0.180356, 0.18596, 0.189698, 0.193504, 0.197288, 0.200238, 0.202758, 0.204444, 0.20645, 0.208178, 0.210938, 0.21415, 0.218388, 0.221534, 0.225108, 0.228838, 0.232334, 0.236264, 0.239808, 0.243986, 0.247462, 0.251276, 0.25514, 0.25917, 0.263594, 0.267466, 0.270326, 0.27195, 0.273624, 0.275584, 0.277774, 0.280602, 0.283372, 0.286588, 0.29006, 0.293606, 0.297452, 0.301618, 0.3065, 0.310288, 0.313668, 0.316988, 0.320028, 0.323316, 0.325632, 0.328918, 0.333404, 0.337528, 0.33969, 0.341556, 0.342884, 0.34471]
"""10-bit M-All-100%"""
# error_in_time = [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0002, 0.0014, 0.0029, 0.0054, 0.0076, 0.0107, 0.0137, 0.0161, 0.0192, 0.0227, 0.0252, 0.0268, 0.0286, 0.0302, 0.0306, 0.0310, 0.0312, 0.0313, 0.0315, 0.0322, 0.0330, 0.0340, 0.0352, 0.0364, 0.0378, 0.0393, 0.0417, 0.0447, 0.0479, 0.0521, 0.0560, 0.0595, 0.0645, 0.0675, 0.0725, 0.0755, 0.0778, 0.0804, 0.0818, 0.0837, 0.0849, 0.0860, 0.0868, 0.0873, 0.0879, 0.0884, 0.0890, 0.0896, 0.0907, 0.0919, 0.0933, 0.0952, 0.0976, 0.0996, 0.1028, 0.1059, 0.1091, 0.1143, 0.1174, 0.1220, 0.1246, 0.1289, 0.1313, 0.1356, 0.1384, 0.1412, 0.1441, 0.1457, 0.1496, 0.1505, 0.1521, 0.1527, 0.1540, 0.1543, 0.1549, 0.1553, 0.1558, 0.1562, 0.1567, 0.1573, 0.1581, 0.1589, 0.1601, 0.1617, 0.1630, 0.1646, 0.1662, 0.1688, 0.1707, 0.1740, 0.1764, 0.1803, 0.1828, 0.1862, 0.1899, 0.1931, 0.1980, 0.2003, 0.2045, 0.2070, 0.2110, 0.2131]
"""8-bit M-All-100%"""
# error_in_time = [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0016, 0.0029, 0.0043, 0.0065, 0.0098, 0.0117, 0.0148, 0.0178, 0.0204, 0.0218, 0.0251, 0.0282, 0.0291, 0.0304, 0.0312, 0.0313, 0.0319, 0.0320, 0.0320, 0.0320, 0.0320, 0.0320, 0.0320, 0.0320, 0.0326, 0.0334, 0.0345, 0.0353, 0.0361, 0.0371, 0.0397, 0.0405, 0.0432, 0.0460, 0.0482, 0.0509, 0.0530, 0.0568, 0.0601, 0.0642, 0.0677, 0.0692, 0.0737, 0.0750, 0.0775, 0.0792, 0.0810, 0.0830, 0.0857, 0.0862, 0.0865, 0.0872, 0.0874, 0.0876, 0.0879, 0.0880, 0.0881, 0.0883, 0.0885, 0.0888, 0.0893, 0.0898, 0.0900, 0.0908, 0.0914, 0.0923, 0.0938, 0.0950, 0.0970, 0.0980, 0.1012, 0.1023, 0.1067, 0.1085, 0.1115, 0.1139, 0.1171, 0.1196, 0.1232, 0.1259, 0.1281, 0.1319, 0.1347, 0.1368, 0.1391, 0.1428, 0.1448, 0.1473, 0.1481, 0.1508, 0.1530, 0.1543, 0.1557, 0.1564, 0.1590, 0.1600, 0.1603, 0.1606, 0.1610, 0.1610]
"""6-bit M-All-100%"""
# error_in_time = [0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0000, 0.0002, 0.0042, 0.0042, 0.0059, 0.0066, 0.0076, 0.0095, 0.0122, 0.0149, 0.0176, 0.0176, 0.0198, 0.0254, 0.0269, 0.0286, 0.0288, 0.0288, 0.0293, 0.0305, 0.0308, 0.0308, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0317, 0.0322, 0.0330, 0.0332, 0.0334, 0.0374, 0.0378, 0.0386, 0.0388, 0.0396, 0.0396, 0.0408, 0.0408, 0.0459, 0.0479, 0.0498, 0.0503, 0.0510, 0.0537, 0.0552, 0.0552, 0.0586, 0.0608, 0.0640, 0.0659, 0.0659, 0.0674, 0.0674, 0.0720, 0.0723, 0.0774, 0.0779, 0.0830, 0.0833, 0.0845, 0.0847, 0.0854, 0.0854, 0.0857, 0.0857, 0.0857, 0.0881, 0.0881, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0886, 0.0891, 0.0898]

"""16-bit M-1-100%"""
# error_in_time = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.002, 0.002, 0.002, 0.002, 0.002, 0.002, 0.002, 0.003, 0.003, 0.003, 0.003, 0.003, 0.004, 0.004, 0.004, 0.004, 0.004, 0.005, 0.005, 0.005, 0.005, 0.006, 0.006, 0.006, 0.006, 0.007, 0.007, 0.007, 0.007, 0.008, 0.008, 0.008, 0.008, 0.009, 0.009, 0.009, 0.009, 0.01, 0.01, 0.01, 0.011, 0.011, 0.011, 0.012, 0.012, 0.012, 0.013, 0.013, 0.013, 0.014, 0.014, 0.014, 0.015, 0.015, 0.015, 0.016, 0.016, 0.017, 0.017, 0.017, 0.018, 0.018, 0.018, 0.019, 0.019, 0.02, 0.02, 0.021, 0.021, 0.022, 0.022, 0.023, 0.023, 0.023, 0.024, 0.024, 0.025, 0.026, 0.026, 0.027, 0.027]
"""10-bit M-1-100%"""
# error_in_time = 
"""8-bit M-1-100%"""
# error_in_time = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0001, 0.0001, 0.0001, 0.0002, 0.0004, 0.0008, 0.0008, 0.0009, 0.001, 0.0011, 0.0017, 0.0017, 0.0017, 0.002, 0.0022, 0.0024, 0.0026, 0.0028, 0.003, 0.0032, 0.0034, 0.0039, 0.0041, 0.0041, 0.0045, 0.0048, 0.0052, 0.0055, 0.0058, 0.0062, 0.0065, 0.0072, 0.0078, 0.0084, 0.009, 0.0094, 0.0095, 0.0099, 0.0101, 0.0111, 0.0118, 0.0125, 0.0127, 0.013, 0.0133, 0.0139, 0.0141, 0.0147, 0.0148, 0.0154, 0.0158, 0.016, 0.0165, 0.0167, 0.0174, 0.0178, 0.0183, 0.0185, 0.0193, 0.0197, 0.0204, 0.0207, 0.0209, 0.0213, 0.0217, 0.0223, 0.0225, 0.0231, 0.0236, 0.0244, 0.0247, 0.0248, 0.0253, 0.0257, 0.0259, 0.0265, 0.0273, 0.0279, 0.0283, 0.0289, 0.0291, 0.0293, 0.0298, 0.0303, 0.0309, 0.0311, 0.032, 0.0325, 0.033, 0.0335, 0.0337, 0.0344, 0.0349, 0.0355, 0.0365, 0.0371, 0.0373]
"""6-bit M-1-100%"""
# error_in_time = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0007, 0.0007, 0.0007, 0.0007, 0.0012, 0.0012, 0.0012, 0.002, 0.0039, 0.0039, 0.0039, 0.0039, 0.0051, 0.0051, 0.0051, 0.0054, 0.0061, 0.0061, 0.0061, 0.0061, 0.0066, 0.0071, 0.0071, 0.0085, 0.0093, 0.0093, 0.0093, 0.0098, 0.0098, 0.01, 0.011, 0.011, 0.011, 0.012, 0.0127, 0.0127, 0.0127, 0.0132, 0.0132, 0.0149, 0.0149, 0.0149, 0.0159, 0.0159, 0.0159, 0.0193, 0.0193, 0.0193, 0.0193, 0.0193, 0.02, 0.0205, 0.0212, 0.0227, 0.0242, 0.0247, 0.0251, 0.0256, 0.0266, 0.0266, 0.0266, 0.0276, 0.0281, 0.0288, 0.0288, 0.0293, 0.0293, 0.0298, 0.0308, 0.0308, 0.0317, 0.032, 0.0322, 0.0322, 0.0322, 0.0327, 0.0327, 0.0332, 0.0332, 0.0334, 0.0337, 0.0337, 0.0354, 0.0356, 0.0356, 0.0356, 0.0361, 0.0361, 0.0364, 0.0364]


###################################### Wallace Tree multiplier